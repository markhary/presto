# presto
Presto backend API coding challenge

## Table of Contents

- [presto](#presto)
  * [Table of Contents](#table-of-contents)
  * [Task](#task)
     + [Specifics](#specifics)
     + [Requirements](#requirements)
  * [Design](#design)
     + [Architecture](#architecture)
     + [Trade Offs](#trade-offs)
  * [Server](#server)
     + [Running the server](#running-the-server)
  * [Client](#client)
  * [Database Schema](#database-schema)
  * [Future Work](#future-work)
  * [License](#license)

<small><i><a href='http://ecotrust-canada.github.io/markdown-toc/'>Table of contents generated with markdown-toc</a></i></small>


## Task

Utilizing your language of choice, design a RESTful web service API call that will return a list of menu items for a specific restaurant.

### Specifics

For this API call, the front end will target path 
`/restaurant/:restaurantId/item`.

```java
public Observable<Response> execute(Request request) {
URL url = new URL("https://api.presto.com/restaurant/1/item");
HttpURLConnection con = url.openConnection();
}
```

The expected response will be parsed directly from JSON to a list of Item objects.

```java
execute(request).subscribe(response -> {
Type listType = new TypeToken<List<Item>>(){}.getType();
List<Item> items = new Gson().fromJson(response, listType); });
```

### Requirements

This challenge is centered around the concept of communicating throughout the stack from the backend, so each part of that communication stack is required:

1. Handle the request from the front end
2. Connect to and query from a Postgres database instance
3. Send the response to the front end

The data model structure is up to you, it’s assumed that the frontend will mimic your object layout for seamless parsing. The only requirement is that the Item object must contain a list of modifiers (ex. Side item, Topping, Sauce). Hint - modifiers can also have modifiers (think dressing choices for side salad).

Scalability is paramount. The code you build should not end up being a bottleneck down the road (will this have to be rebuilt when it’s being hit 100x as frequently?).

## Design

### Architecture

- **Framework**: I am using JavaScript, simply because I am very familiar with it.  This naturally means I will use Node and Express.
- **API Design**: [Swagger Editor](http://editor.swagger.io) to generate the [API contract](https://swagger.io/blog/api-development/why-you-should-create-an-api-definition/) and swagger-codegen to generate the node server using express.
- **Scalability**: [Node](https://nodejs.org/en/) is commonly used for designing production ready [scalable and concurrent](https://en.wikipedia.org/wiki/Node.js#Platform_architecture) backend systems.  If you are writing a backend using javascript (I am), then node is your huckleberry.
- **Database**: Postgresql, because it was specified in the challenge.
- **Database Connectivity**: Using [Sequelize](https://sequelize.readthedocs.io/en/1.7.0/), which is the most popular (by download statistics) SQL ORM software package:
	+ [Sequelize](https://sequelize.readthedocs.io/en/1.7.0/) The Sequelize library is an ORM (Object-Relational-Mapper) which provides easy access to MySQL, MariaDB, SQLite or PostgreSQL databases by mapping database entries to objects and vice versa.
	+ [List](https://www.npmjs.com/search?q=ORM&ranking=popularity) of most popular ORM packages according to [npmjs](https://www.npmjs.com)
	+ [Comparison](https://www.npmtrends.com/mongoose-vs-sequelize) of mongoose vs sequalize over last 6 months
- **Security**: There is none, due to the nature of the challenge.

### Trade Offs

- I chose not to use python and django because I am unfamiliar with them and preferred to complete this challenge with tools I am proficient with.
- Using [Sequelize](https://sequelize.readthedocs.io/en/1.7.0/) over [Mongoose](https://mongoosejs.com) because challenge calls for it.  Trade-off here is lilliputian battle of [SQL vs NoSQL](https://www.thegeekstuff.com/2014/01/sql-vs-nosql-db/).
- No security, never do this, ever. period.

## Server
This server was generated by the [swagger-codegen](https://github.com/swagger-api/swagger-codegen) project.  By using the [OpenAPI-Spec](https://github.com/OAI/OpenAPI-Specification) from a remote server, you can easily generate a server stub.

### Running the server
To run the server for the first time, run:

```
cd modules/restaurant/server
npm start
```

To run just the server, run:

```
node server.js
```

To view the Swagger UI interface:

```
open http://localhost:8080/docs
```

This project leverages the mega-awesome [swagger-tools](https://github.com/apigee-127/swagger-tools) middleware which does most all the work.

## Client

Read the Client instructions [here](modules/restaurant/client/README.md).  Here is a shortcut:

```
cd modules/restaurant/client
npm install
```

and to test:

```
npm test
```

## Database Schema

Link to actual schema

## Future Work
These are things I would do if this were a real module and not an interview challenge:

* Cannot stress implement proper security enough - https, SSL connection to DB, secure DB, API keys, API authentication, etc.
* Performance tests:
  - 100 simultaneous clients
  - 1000 items (with recursion)
     - random item generator
     - Both of these scalable
     - connection reliability (intermittent connections)
     - low bandwidth connectivity (e.g. 1 Mbps down, 0.04 Mbps up)
  - Resource graphcs under load testing
     - Memory, CPU usage 
     - Perf statistics
     - SQL call duration
     - gprof
     - O(N) estimation
* Protection against cyclic graphs, e.g.:

***Item Table:***

ItemID | Name                 | Description
-------|----------------------|---------------
1      | Hamburger            | Food
2      | Green Salad          | Leafy
3      | Blue Cheese Dressing | Tasty
4      | Blue Cheese          | Splurge!

***Menu Table: Check for cyclic association in table***

ItemID | Modifies| Note   | Recursion
-------|---------|--------|-------------
1      | NULL    | Top level item |
2      | 1       | Green Salad as side to burger |
3      | 2       | Blue Cheese Dressing for salad |
4      | 3       | Extra blue cheese | ***Cyclic dependency*** |
3      | 4       | Blue Cheese Dressing for blue cheese |***Cyclic dependency*** |



## License

Licensed under the [Unlicense](LICENSE).
